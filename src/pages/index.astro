---
import Layout from '../layouts/Layout.astro';
---

<Layout title="Living with the Ghost of Sam">
    <div id="splash" class="splash-container">
        <div class="login-box">
            <h1>Welcome</h1>
            <div class="password-input">
                <label for="password">Professor Who?</label>
                <input type="password" id="password" />
            </div>
            <button id="submit-btn" class="btn">Enter</button>
            <p id="error-message" class="error"></p>
        </div>
        <div id="image-box">
            <img src="/images/SamImagesmall.jpg" id="sam-image" alt="Sam" />
        </div>
    </div>

    <!-- Rest of your content HTML remains the same -->
</Layout>

<style>
    /* Updated CSS with proper specificity */
    .splash-container {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: #13151a;
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 1000;
        overflow: hidden;
    }

    #image-box {
        position: absolute;
        width: 300px;
        height: 200px;
        transition: transform 0.5s ease-in-out;
        background: rgba(255, 255, 255, 0.1);
        pointer-events: none;
        /* Ensure the image box appears behind the login box */
        z-index: 1000;
    }

    .login-box {
        background: rgba(255, 255, 255, 0.1);
        padding: 2rem;
        border-radius: 8px;
        text-align: center;
        color: white;
        /* Ensure login box appears above the image */
        z-index: 1001;
        position: relative;
    }

    #sam-image {
        width: 100%;
        height: 100%;
        object-fit: cover;
        display: block;
    }

    /* Rest of your CSS remains the same */
</style>

<script>
    // Modified JavaScript for better initialization
    document.addEventListener('DOMContentLoaded', function() {
        const imageBox = document.getElementById('image-box');
        
        if (!imageBox) {
            console.error('Image box not found');
            return;
        }

        function randomPosition() {
            const viewportWidth = window.innerWidth;
            const viewportHeight = window.innerHeight;
            
            const boxWidth = imageBox.offsetWidth;
            const boxHeight = imageBox.offsetHeight;
            
            const maxX = viewportWidth - boxWidth;
            const maxY = viewportHeight - boxHeight;
            
            const x = Math.max(0, Math.min(Math.floor(Math.random() * maxX), maxX));
            const y = Math.max(0, Math.min(Math.floor(Math.random() * maxY), maxY));
            
            return { x, y };
        }

        function moveImageBox() {
            const { x, y } = randomPosition();
            // Force GPU acceleration and ensure transform is applied
            imageBox.style.transform = `translate3d(${x}px, ${y}px, 0)`;
            imageBox.style.webkitTransform = `translate3d(${x}px, ${y}px, 0)`;
        }

        // Ensure initial position is set
        requestAnimationFrame(() => {
            moveImageBox();
            // Start the interval after initial position is set
            setInterval(moveImageBox, 3000);
        });

        // Handle window resizing
        window.addEventListener('resize', moveImageBox);
    });

    // Rest of your authentication code remains the same
</script>
